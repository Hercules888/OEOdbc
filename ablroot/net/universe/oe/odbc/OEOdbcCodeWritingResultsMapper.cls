/*------------------------------------------------------------------------
This file is part of the OEOdbc library, an OpenEdge ABL wrapper
around the ODBC libraries.


Copyright (C) 2013 hercules888@gmail.com

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA

http://www.gnu.org/licenses/lgpl-2.1.txt
----------------------------------------------------------------------*/

USING net.universe.oe.odbc.*.
{net/universe/oe/odbc/oe-odbc-defs.i}

ROUTINE-LEVEL ON ERROR UNDO, THROW.



CLASS net.universe.oe.odbc.OEOdbcCodeWritingResultsMapper INHERITS OEOdbcResultsMapper:

  def stream sIn.
  def stream sOut.
  def private var hTT as handle no-undo.

  def public property cOutputFilePath    as char no-undo init ?
  public get.
  public set.
  
  def public property cTemplateFilePath  as char no-undo init 'net/universe/oe/odbc/OEOdbcResultsMapperClass.template'
  public get.
  public set.
  
  def public property cOEOdbcPackage     as char no-undo
  public get.
  public set.
  
  def public property cOEOdbcClass       as char no-undo
  public get.
  public set.
  
  def public property cOEOdbcPackagePath as char no-undo init ?
  public get.
  public set.
  
  def public property cOEOdbcTemptable   as char no-undo init ?
  public get.
  public set.
  
  def private var cTagOEOdbcPackage          as char no-undo init 'ο胚夏旅咝撩肆桥'.
  def private var cTagOEOdbcClass            as char no-undo init 'ο胚夏旅呙塘佑'.
  def private var cTagOEOdbcPackagePath      as char no-undo init 'ο胚夏旅咝撩肆桥咝猎叁М溴痱轹狒鲠阍徵吓箱忏藻眇翎忪狍汨狎铒躅滹轭轸ο胚夏旅咴磐性谅膛'.
  def private var cTagOEOdbcBeginFieldRepeat as char no-undo init 'ο胚夏旅呗徘晌咂膳棠咭判帕轧М溴痱轹狒鲠阍徵吓箱忏蓬淦殄熹义疱狒狍汨狎铒躅滹轭轸ο胚夏旅吲文咂膳棠咭判帕轧М溴痱轹狒鲠阍徵吓箱忏崎屐湮犴狍汨狎铒躅滹轭轸ο胚夏旅咂膳棠瘟团'.
  def private var cTagOEOdbcFieldNullable    as char no-undo init 'ο胚夏旅咂膳棠呶仗塘绿毗М溴痱轹狒鲠阍徵吓箱忏谅唐殄熹赠疱狍汨狎铒躅滹轭轸ο胚夏旅吡绿咂膳棠再信'.
  def private var cTagOEOdbcABLMemptrGetFunc as char no-undo init 'ο胚夏旅吡绿咄磐性疫桥云瘴摸М铄舣躅轹弪箦镥镤忏趑吓箱忏蔑祯眍湾翎溽翎σ牌乓盼门衔藤揭牌乓盼门衔藤τ孟信叫疑至耘孟斡砸彰韵姓绿擅吓箱忏蔑溴昨轸轭缫弩蹯趔歪痧弪ㄩ铕豸翎忪瀛栳钿戾柙忾钿┖篚疱颞柙袁楷咯盼孟斡砸彰韵耶团匀夏幸芍猎萌烈珏袅绿崎屐湓疱蛮友唐殄熹赠疱ㄩ铕豸槟狒嵩疱狍轭舂善槟狒嵩疱τ烟咦至颐攘引矧槟狒嵩疱τ烟咧烈萌烈矧槟狒嵩疱τ烟呙攘引矧槟狒嵩疱τ烟咦萌烈翳孱蝈趱蝾萌烈撩耘咬善槟狒嵩疱τ烟呱卧徘乓翳孱蝈趱蝾晌耘桥咬善槟狒嵩疱τ烟呗稍翳孱蝈趱蝾滔巧昧抬殒槟狒嵩疱τ烟呗汕晌札矧槟狒嵩疱τ烟呶胀乓擅翳孱蝈趱蝾呐蒙土抬殒槟狒嵩疱τ烟吣险绿琵矧槟狒嵩疱τ烟吣琶赏撂翳孱蝈趱蝾呐蒙土抬殒槟狒嵩疱τ烟咂滔猎翳孱蝈趱蝾呐蒙土抬殒槟狒嵩疱τ烟咴傩胚牧耘翳孱蝈趱蝾牧耘М殒槟狒嵩疱τ烟咴傩胚陨团釉镣旋翳孱蝈趱蝾牧耘陨团在М蝈趱蝾⒖靠瘴诱行弦耘再信á篝蜷铉ㄩ尼翎赠疱靠竣盼团匀夏团匀夏幸芍猎萌烈珏袅绿湾眇趄清翩躅懵友唐殄熹赠疱ㄩ铕豸槟狒嵩疱狍轭舂善槟狒嵩疱τ烟咦至颐攘引矧槟狒嵩疱τ烟咧烈萌烈矧槟狒嵩疱τ烟呙攘引矧槟狒嵩疱τ烟咦萌烈翳孱蝈趱蝾в砸晌千善槟狒嵩疱τ烟呱卧徘乓翳孱蝈趱蝾滔吻М善槟狒嵩疱τ烟呗稍翳孱蝈趱蝾滔吻М殒槟狒嵩疱τ烟咴傩胚陨团釉镣旋翳孱物篚痧矧翦弭殒槟狒嵩疱τ烟呗汕晌札矧槟狒嵩疱τ烟呶胀乓擅翳孱蝈趱蝾南章膛М殒槟狒嵩疱τ烟吣险绿琵矧槟狒嵩疱τ烟吣琶赏撂翳孱蝈趱蝾南章膛М殒槟狒嵩疱τ烟咂滔猎翳孱蝈趱蝾铺狭鸳蝈趱蝾⒖靠瘴诱行弦耘再信á篝蜷铉ㄩ尼翎赠疱靠竣盼团匀夏团匀夏姓绿擅现乓疑呐晌轸弪狒辶钿歪鹨弩蹯趔ㄉ涡赵镄郁眙劣吓箱忏序屦狎邃郁狒屙孱舂溴鲠闾轭狍汨狎铒躅滹溴鲠阄鬻涕铄狍汨狎铒躅滹溴鲠焐盥祜汶狍祜铒躅滹轭轸驷祗瀹溴鲠橛翎螋射狍轭铒躅滹溴鲠榕钿射狍轭铒躅滹溴鲠阋屦遽粜狎狍汨狎铒躅滹轭轸Ё溴鲠阋屦遽粜狎粑鬻狍汨狎铒躅滹溴鲠镉翎翦礤铘湾翎溽翎狍铄舢躅轹弪箦镥镤忏吓箱忏郁狒屙孱敉弭徜狒铒躅滹镉翎翦礤铘湾翎溽翎镄篝眙猴郁狒屙孱敉弭徜狒岙镉翎翦礤铘湾翎溽翎衡轭涿镬蹴钔弭徜狒屺秕麴豸翎忪趑吓箱忏蔑祯眍湾翎溽翎忾钿┊善阆畔溻阈徙脶珏嗅翳匀盼狍箝珙阆畔溻阈徙脶珏嗅翳蝈痨徙濞阆畔溻阈徙脶珏МКНЗ善阆畔溻阍屙痿徕戾匀盼狍箝珙阆畔溻阍屙鹪徕戾趑阆畔溻忝灬篌轭瘐篝蝈犴笊骝镯鲠祯濞箦狎汨ㄣ藻眇灬翦崎戾嗅翳┅秕麴豸篝蝈犴笙豸麸鲠祯濞阆豸瘐羝殪逍狒瑭遗信猎轫痫螋篝蝈犴笊躅骘蝽狒翦闾轭瀹善铒焐盥祜汶匀盼滹狍箝珙阄鬻涕铄闾轭阄鬻涕铄蝈痨徙濞阄鬻涕铄阍徵吓箱忏嗅汶徵瀣阆畔溻阈徙脶珏阄鬻涕铄蝈痨徙濞阄鬻涕铄阍徵吓箱忏渺狍蟋阆畔溻忝灬篌阄鬻涕铄蝈痨徙濞阄鬻涕铄阍徵吓箱忏嗅汶徵逍狒璎阆畔溻阈徙脶珏嗅翳阄鬻涕铄蝈痨徙濞阄鬻涕铄阍徵吓箱忏藻眇翎忪瀣阆畔溻阍屙痿徕戾闾轭阄鬻涕铄橛翎螋射轭溴ㄣ涕铄阍徵吓箱忏洛玳钇殄熹义疱狒┊善橛翎螋射匀盼狍箝珙阄鬻涕铄篚怏趄ㄣ涕铄爆橛翎螋射暴闾轭篚怏趄ㄣ涕铄橛翎螋射戾铉翳ㄣ葬缦畔溻懵彗轭崎屐湟屦遽舂焐盥祜汶趄蹂瘐篝蝈犴笙豸躅骘蝽狒翦阄鬻涕铄箅轲盼漠善焐盥祜汶匀盼滹榕钿射颦轭溴ㄣ涕铄阍徵吓箱忏蓬淦殄熹义疱狒┊狍箝珙阋屦遽粜狎阋屦遽粜狎ㄉ榕钿射匀盼篚怏趄ㄣ涕铄爆榕钿射暴屐箦闾轭濠善榕钿射匀盼滹狍箝珙阋屦遽粜狎义痨徙濞阋屦遽粜狎衄阍徵吓箱忏藻眇翎忪瀣阆畔溻阍屙痿徕戾┊葡遽汨趑吓箱忏蔑祯眍湾翎溽翎麒弪泔祯眍钺礤季Ё铒祜汶怡泔祯眍轭溴狍箝珙阋屦遽粜狎粑鬻义痨徙濞阋屦遽粜狎衄阍徵吓箱忏崎屐湮犴瀣趑吓箱忏蔑祯眍湾翎溽翎蔑祯眍吾礤┊善轭溴ㄣ义疱狒嗅螋五鳜阍徵吓箱忏谅唐殄熹赠疱翳孱狍箝珙阋屦遽粜狎粑鬻蝈痨徙濞阋屦遽粜狎粑鬻阍徵吓箱忏谅唐殄熹赠疱珏袅绿崎屐湓疱蛮友唐殄熹赠疱趑吓箱忏蔑祯眍湾翎溽翎尼翎赠疱┅善轭溴ㄣ义疱狒嗅螋五鳜阍徵吓箱忏谅掏屙痿蚯弭契钽翳孱狍箝珙阋屦遽粜狎粑鬻蝈痨徙濞阋屦遽粜狎粑鬻阍徵吓箱忏谅掏屙痿蚯弭契钽珏袅绿湾眇趄清翩躅懵友唐殄熹赠疱趑吓箱忏蔑祯眍湾翎溽翎尼翎赠疱┅善轭溴ㄣ义疱狒嗅螋五鳜阍徵吓箱忏崎屐湮蹯灬忪濠翳孱狍箝珙阋屦遽粜狎粑鬻蝈痨徙濞阋屦遽粜狎粑鬻阍徵吓箱忏崎屐湮蹯灬忪瀣ㄩ趑吓箱忏蔑祯眍湾翎溽翎熙祆徕戾季翳孱屐箦ξ镂蹯膦┅瘐篝蝈犴笙豸躅骘蝽狒翦⒓技阋屦遽粜狎粑鬻⒕揪箅轲盼漠狍箝珙阋屦遽粜狎Ё焐盥祜汶驷祗瀹瘐篝蝈犴笙豸躅骘蝽狒翦篚怏趄ㄣ涕铄榕钿射戾铉翳ㄣ葬缦畔溻闩钿崎屐湟屦遽舂箅轲盼漠橛翎螋射碑盼漠盼漠轭瘐篝蝈犴笊沆矬瀹秕麴豸篝蝈犴笙豸沆矬瀹蔑铙蹴翳蝈篚祠箦铄舣躅轹弪箦镥镤忏上畔溻阋弩蹯趔歪痧弪唔狃蝈氵忮玳町辇铄舣躅轹弪箦镥镤忏上畔溻阋弩蹯趔歪痧弪唔狃蝈氵孱洚辇盼团匀夏盼锰劣赢